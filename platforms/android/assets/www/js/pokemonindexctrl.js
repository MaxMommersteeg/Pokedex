angular.module("starter").controller("PokemonIndexCtrl",["$scope","$http","mapPreferenceKey","userPreferenceKey","pokemonListPreferenceKey","mypokemonsPreferenceKey","baseUrlGetPokemons","defaultMaximumRadius","defaultCatchRadius","defaultPokemonListSize","defaultUser",function(e,n,t,o,a,r,i,l,s,g,u){e.pokemons=[],e.currentCount={},e.nextPageUrl={},e.nextPageExists=!0,e.map={},e.user={},e.pokemonlist={},e.greeting="",e.$on("$ionicView.loaded",function(){e.initialize()}),e.$on("$ionicView.enter",function(){var n=JSON.parse(window.localStorage.getItem(t));null!=n&&(e.map=n);var r=JSON.parse(window.localStorage.getItem(a));null!=r&&(e.pokemonlist=r);var i=JSON.parse(window.localStorage.getItem(o));null!=i&&(e.user=i),e.calculateGreeting()}),e.calculateGreeting=function(){var n=new Date,t=n.getHours();t>=6&&12>t?e.greeting="Good morning":t>=12&&18>t?e.greeting="Good afternoon":t>=18&&24>t?e.greeting="Good evening":e.greeting="Good night",e.greeting=e.greeting+" "+e.user.firstname+"!"},e.initialize=function(){var n=JSON.parse(window.localStorage.getItem(t));null==n&&(e.map.maximumradius=l,e.map.catchradius=s,window.localStorage.setItem(t,JSON.stringify(e.map)));var r=JSON.parse(window.localStorage.getItem(a));null==r?(e.pokemonlist.size=g,window.localStorage.setItem(a,JSON.stringify(e.pokemonlist))):e.pokemonlist=r;var i=JSON.parse(window.localStorage.getItem(o));null==i&&(e.user=u,window.localStorage.setItem(o,JSON.stringify(e.user))),e.getPokemons()},e.getPokemons=function(){e.addPokemonsByUrl(i+e.pokemonlist.size)},e.nextPage=function(){e.addPokemonsByUrl(e.nextPageUrl),null==e.nextPageUrl&&(e.nextPageExists=!1)},e.addPokemonsByUrl=function(t){t&&!angular.equals({},t)&&n.get(t).then(function(n){e.currentCount=n.data.count,e.nextPageUrl=n.data.next,e.previousPageUrl=n.data.previous,e.pokemons=e.pokemons.concat(n.data.results),e.$broadcast("scroll.infiniteScrollComplete")},function(e){})}}]);